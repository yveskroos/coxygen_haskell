-- D√©finition de la classe NousAcceptons avec fonction sp√©ciale
class NousAcceptons a where
    accepter :: a -> Bool
    fonctionSpeciale :: a -> String

-- D√©finition de types personnalis√©s
data Cardano = Cardano deriving (Show)
data Especes = Especes deriving (Show)
data Pays    = Pays String deriving (Show)

-- Instance pour Cardano
instance NousAcceptons Cardano where
    accepter Cardano = True
    fonctionSpeciale c =
        if accepter c
           then "Cardano est accept√© ! üöÄ"
           else "Cardano n'est pas accept√©."

-- Instance pour Esp√®ces (Cash)
instance NousAcceptons Especes where
    accepter Especes = False
    fonctionSpeciale c =
        if accepter c
           then "Les esp√®ces sont accept√©es !"
           else "Les esp√®ces ne sont pas accept√©es ‚ùå"

-- Instance pour Pays
instance NousAcceptons Pays where
    accepter (Pays nom) = nom == "France" || nom == "C√¥te d'Ivoire"
    fonctionSpeciale c@(Pays nom) =
        if accepter c
           then "Bienvenue de " ++ nom ++ " ‚úÖ"
           else "D√©sol√©, " ++ nom ++ " n'est pas accept√© ‚ùå"

-- Programme principal de test
main :: IO ()
main = do
    putStrLn (fonctionSpeciale Cardano)
    putStrLn (fonctionSpeciale Especes)
    putStrLn (fonctionSpeciale (Pays "France"))
    putStrLn (fonctionSpeciale (Pays "Allemagne"))
    putStrLn (fonctionSpeciale (Pays "C√¥te d'Ivoire"))
