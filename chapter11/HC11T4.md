-- Définition du type Present
data Present a = Aucun | Cadeau a
    deriving (Show, Eq)

-- Définition de la classe Conteneur
class Conteneur c where
    estVide    :: c a -> Bool
    contient   :: (Eq a) => a -> c a -> Bool
    remplacer  :: a -> c a -> c a

-- Instance de Conteneur pour Present
instance Conteneur Present where
    estVide Aucun         = True
    estVide (Cadeau _)    = False

    contient _ Aucun      = False
    contient x (Cadeau y) = x == y

    remplacer x Aucun      = Cadeau x
    remplacer x (Cadeau _) = Cadeau x

-- Programme principal de test
main :: IO ()
main = do
    let p1 = Aucun
    let p2 = Cadeau "Livre"
    let p3 = remplacer "Smartphone" p2

    putStrLn "Test avec p1 (Aucun) :"
    print (estVide p1)             -- True
    print (contient "Livre" p1)    -- False
    print (remplacer "Montre" p1)  -- Cadeau "Montre"

    putStrLn "\nTest avec p2 (Cadeau \"Livre\") :"
    print (estVide p2)             -- False
    print (contient "Livre" p2)    -- True
    print (contient "Montre" p2)   -- False

    putStrLn "\nAprès remplacement p3 (Cadeau \"Smartphone\") :"
    print p3                       -- Cadeau "Smartphone"
    print (contient "Smartphone" p3) -- True
