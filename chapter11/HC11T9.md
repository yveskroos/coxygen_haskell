import Data.List (sort) 

-- Définition du type Longueur avec unités
data Longueur = Metres Double | Km Double
    deriving (Show, Eq)

-- Instance Ord pour Longueur (comparaison manuelle)
instance Ord Longueur where
    compare (Metres m1) (Metres m2) = compare m1 m2
    compare (Km k1) (Km k2)         = compare k1 k2
    compare (Metres m) (Km k)       = compare m (k * 1000)  -- Conversion Km -> m
    compare (Km k) (Metres m)       = compare (k * 1000) m  -- Conversion Km -> m

-- Programme principal de test
main :: IO ()
main = do
    let l1 = Metres 500
    let l2 = Km 1
    let l3 = Metres 1500
    let l4 = Km 0.5

    -- Test des égalités
    print (l1 == l4)  -- True (500 m == 0.5 km)
    print (l2 == l3)  -- False (1 km != 1500 m)

    -- Test des comparaisons
    print (l1 < l2)   -- True (500 m < 1000 m)
    print (l3 > l2)   -- True (1500 m > 1000 m)
    print (compare l1 l4)  -- EQ
    print (compare l3 l2)  -- GT

    -- Exemple avec une liste triée
    let listeLongueurs = [l3, l1, l2, l4]
    print (sort listeLongueurs)  
    -- Résultat attendu : [Metres 500,Km 0.5,Km 1,Metres 1500]
