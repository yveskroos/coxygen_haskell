-- Définition du type Box
data Box a = EmptyBox | Box a
    deriving (Show, Eq)

-- Définition de la classe Container
class Container c where
    isEmpty   :: c a -> Bool
    contains  :: (Eq a) => a -> c a -> Bool
    replace   :: a -> c a -> c a

-- Instance de Container pour Box
instance Container Box where
    isEmpty EmptyBox     = True
    isEmpty (Box _)      = False

    contains _ EmptyBox  = False
    contains x (Box y)   = x == y

    replace x EmptyBox   = Box x
    replace x (Box _)    = Box x

-- Programme principal de test
main :: IO ()
main = do
    let b1 = EmptyBox
    let b2 = Box 42
    let b3 = replace 100 b2

    putStrLn "Test avec b1 (EmptyBox) :"
    print (isEmpty b1)            -- True
    print (contains 42 b1)        -- False
    print (replace 10 b1)         -- Box 10

    putStrLn "\nTest avec b2 (Box 42) :"
    print (isEmpty b2)            -- False
    print (contains 42 b2)        -- True
    print (contains 99 b2)        -- False

    putStrLn "\nAprès remplacement b3 (Box 100) :"
    print b3                      -- Box 100
    print (contains 100 b3)       -- True
