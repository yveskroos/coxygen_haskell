module Main where

-- Définition d'un type personnalisé Result
data Result a = Success a | Error String
    deriving (Show, Eq)

-- Fonction avec pattern matching et @
describeResult :: Show a => Result a -> String
describeResult res@(Success _) = "Succès : " ++ show res
describeResult err@(Error msg) = "Erreur : " ++ msg ++ " (" ++ show err ++ ")"

main :: IO ()
main = do
    let r1 = Success 42        :: Result Int
        r2 = Error "Division par zéro" :: Result Int  -- annotation du type pour lever l'ambiguïté
    
    putStrLn "Exemples de pattern matching avec @ :"
    putStrLn (describeResult r1)  -- Résultat : Succès : Success 42
    putStrLn (describeResult r2)  -- Résultat : Erreur : Division par zéro (Error "Division par zéro")
