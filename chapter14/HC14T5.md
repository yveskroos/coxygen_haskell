module Main where

-- Définition d'un type paramétré Result
data Result a
    = Success a
    | Error String
    deriving (Show, Eq)

-- Fonction qui traite un Result avec pattern matching et @
describeResult :: Result a -> String
describeResult r@(Success val) = "Succès avec la valeur : " ++ show val ++ " (pattern r = " ++ show r ++ ")"
describeResult (Error msg)      = "Erreur : " ++ msg

main :: IO ()
main = do
    let r1 = Success 42
        r2 = Error "Quelque chose a mal tourné"
    
    putStrLn "Exemples de pattern matching avec @ :"
    putStrLn (describeResult r1)  -- Succès avec la valeur : 42 ...
    putStrLn (describeResult r2)  -- Erreur : Quelque chose a mal tourné
