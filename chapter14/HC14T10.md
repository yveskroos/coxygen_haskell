-- src/Counts.hs
module Counts (count) where

-- compte le nombre d’occurrences d’un élément dans une liste
count :: Eq a => a -> [a] -> Int
count x = length . filter (== x)


Dans ton fichier .cabal, ajoute une section test-suite
test-suite counts-tests
  type: exitcode-stdio-1.0
  main-is: Spec.hs
  hs-source-dirs: test, src
  build-depends: base >=4.7 && <5
               , tasty
               , tasty-hunit
               , projet       
  default-language: Haskell2010



test/Spec.hs
-- test/Spec.hs
import Test.Tasty
import Test.Tasty.HUnit
import Counts (count)

main :: IO ()
main = defaultMain tests

tests :: TestTree
tests = testGroup "Tests pour la fonction count"
  [ testCase "compte dans une liste vide" $
      count 1 [] @?= 0

  , testCase "compte un élément présent une fois" $
      count 2 [1,2,3] @?= 1

 , testCase "compte un élément présent plusieurs fois" $
       count 'a' "banane" @?= 2

  , testCase "compte un élément absent" $
      count 42 [1,2,3] @?= 0

  , testCase "compte dans une grande liste" $
      count True (replicate 1000 True ++ replicate 500 False) @?= 1000
  ]


