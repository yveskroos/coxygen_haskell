-- HC15T8 : Fonction Soit (Either) pour messages d'erreur détaillés en division

module Main where

-- Division sécurisée avec Either
safeDiv :: Double -> Double -> Either String Double
safeDiv _ 0 = Left "Erreur : division par zéro interdite."
safeDiv x y
    | y < 0     = Left "Erreur : le dénominateur est négatif."
    | otherwise = Right (x / y)

-- Exemple d'utilisation
main :: IO ()
main = do
    putStrLn "=== Division sécurisée avec Either ==="

    -- Exemple correct
    case safeDiv 10 2 of
        Right result -> putStrLn $ "Résultat (10 / 2) : " ++ show result
        Left err     -> putStrLn err

    -- Division par zéro
    case safeDiv 10 0 of
        Right result -> putStrLn $ "Résultat (10 / 0) : " ++ show result
        Left err     -> putStrLn err

    -- Dénominateur négatif
    case safeDiv 10 (-3) of
        Right result -> putStrLn $ "Résultat (10 / -3) : " ++ show result
        Left err     -> putStrLn err

