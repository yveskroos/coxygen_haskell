
-- HC15T5 : Division sécurisée avec Maybe

module Main where

-- Version générique pour types Fractional (Float, Double, Rational...)
safeDiv :: (Eq a, Fractional a) => a -> a -> Maybe a
safeDiv _ 0 = Nothing
safeDiv x y = Just (x / y)

-- Version utile pour entiers : retourne un Double (évite la division entière)
safeDivInt :: (Integral a) => a -> a -> Maybe Double
safeDivInt _ 0 = Nothing
safeDivInt x y = Just (fromIntegral x / fromIntegral y)

-- Programme principal avec exemples
main :: IO ()
main = do
    putStrLn "Exemples de safeDiv (Fractional) :"
    print (safeDiv 10 2    :: Maybe Double)   -- Just 5.0
    print (safeDiv 10 0    :: Maybe Double)   -- Nothing
    print (safeDiv 7.5 2.5 :: Maybe Double)   -- Just 3.0

    putStrLn "\nExemples de safeDivInt (Integral -> Double) :"
    print (safeDivInt (10 :: Int) (3 :: Int)) -- Just 3.3333333333333335
    print (safeDivInt (10 :: Int) 0)          -- Nothing
