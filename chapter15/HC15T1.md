{-# LANGUAGE ScopedTypeVariables #-}

module Main where

import System.IO
import Control.Exception
import Text.Read (readMaybe)

main :: IO ()
main = do
    putStrLn "Lecture du fichier distance.txt..."
    distanceResult <- try (readFile "distance.txt") :: IO (Either IOException String)
    case distanceResult of
        Left ex -> putStrLn $ "Erreur lors de la lecture du fichier : " ++ show ex
        Right content -> do
            -- Essayons de convertir le contenu en Double
            case readMaybe content :: Maybe Double of
                Nothing -> putStrLn "Le contenu du fichier n'est pas un nombre valide."
                Just distance -> do
                    putStrLn "Entrez le temps en heures :"
                    input <- getLine
                    case readMaybe input :: Maybe Double of
                        Nothing -> putStrLn "Entrée invalide : ce n'est pas un nombre."
                        Just temps -> 
                            if temps == 0
                            then putStrLn "Erreur : division par zéro impossible."
                            else do
                                let vitesse = distance / temps
                                putStrLn $ "Vitesse calculée : " ++ show vitesse ++ " km/h"
