-- HC15T7 : Calcul de vitesse avec gestion des valeurs optionnelles et du parsing

module Main where

import Text.Read (readMaybe)

-- Division sécurisée avec Maybe
safeDiv :: Double -> Double -> Maybe Double
safeDiv _ 0 = Nothing
safeDiv x y = Just (x / y)

-- Fonction pour demander un nombre de type Double
askDouble :: String -> IO (Maybe Double)
askDouble message = do
    putStrLn message
    input <- getLine
    return (readMaybe input :: Maybe Double)

-- Calcul de la vitesse avec gestion d'erreurs
calculateSpeed :: Maybe Double -> Maybe Double -> Maybe Double
calculateSpeed (Just d) (Just t) = safeDiv d t
calculateSpeed _ _               = Nothing

main :: IO ()
main = do
    putStrLn "=== Calcul de vitesse ==="
    distance <- askDouble "Entrez la distance parcourue (en km) :"
    time     <- askDouble "Entrez le temps mis (en heures) :"

    let speed = calculateSpeed distance time
    case speed of
        Just v  -> putStrLn $ "Vitesse calculée : " ++ show v ++ " km/h"
        Nothing -> putStrLn "Erreur : valeurs invalides ou division par zéro."

