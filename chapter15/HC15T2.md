module Main where

-- Définir le type des feux
data TrafficLight = Red | Yellow | Green deriving (Show, Read, Eq)

-- Fonction qui décide l'action de la voiture selon le feu
action :: TrafficLight -> String
action Red    = "Arrêter la voiture !"
action Yellow = "Ralentir !"
action Green  = "Avancer !"

-- Fonction pour lire la couleur depuis l'utilisateur
readLight :: IO (Maybe TrafficLight)
readLight = do
    putStrLn "Entrez la couleur du feu (Red, Yellow, Green) :"
    input <- getLine
    case reads input :: [(TrafficLight, String)] of
        [(light, "")] -> return (Just light)
        _             -> do
            putStrLn "Entrée invalide. Veuillez réessayer."
            return Nothing

main :: IO ()
main = do
    maybeLight <- readLight
    case maybeLight of
        Nothing -> main  -- boucle jusqu'à une entrée correcte
        Just light -> putStrLn $ "Décision de la voiture : " ++ action light

