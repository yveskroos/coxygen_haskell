-- Définition du type Severity avec Ord
data Severity = Low | Medium | High | Critical
  deriving (Show, Eq, Ord)  -- Ord permet l'utilisation de max

-- Instance Semigroup où le niveau le plus élevé l'emporte
instance Semigroup Severity where
    Low <> x      = x
    Medium <> x   = max Medium x
    High <> x     = max High x
    Critical <> _ = Critical

-- foldWithSemigroup combine tous les éléments d'une liste avec foldr et <>
foldWithSemigroup :: Semigroup a => [a] -> a
foldWithSemigroup []     = error "Liste vide : impossible de combiner"
foldWithSemigroup (x:xs) = foldr (<>) x xs

main :: IO ()
main = do
    let severities = [Low, High, Medium]
    print $ foldWithSemigroup severities  -- Résultat : High
