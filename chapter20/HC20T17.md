import Data.Char (isUpper, isLower, isDigit)

-- Fonction de validation du mot de passe
validatePassword :: String -> Either String String
validatePassword pwd
    | length pwd < 8 = Left "Le mot de passe doit contenir au moins 8 caractÃ¨res."
    | not (any isUpper pwd) = Left "Le mot de passe doit contenir au moins une majuscule."
    | not (any isLower pwd) = Left "Le mot de passe doit contenir au moins une minuscule."
    | not (any isDigit pwd) = Left "Le mot de passe doit contenir au moins un chiffre."
    | otherwise = Right pwd

-- Exemple d'utilisation
main :: IO ()
main = do
    let passwords = ["abc", "Password", "password1", "PASS1234", "Valid123"]
    mapM_ printResult passwords
  where
    printResult pwd =
        case validatePassword pwd of
            Right valid -> putStrLn $ "Mot de passe valide : " ++ valid
            Left err    -> putStrLn $ "Erreur pour \"" ++ pwd ++ "\": " ++ err

