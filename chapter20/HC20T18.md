import Control.Monad.Trans.Maybe
import Control.Monad.Trans.Class (lift)
import Control.Monad (when)

-- Fonction qui lit une ligne et vérifie qu'elle n'est pas vide
getNonEmptyLine :: MaybeT IO String
getNonEmptyLine = do
    lift $ putStrLn "Veuillez entrer une chaîne non vide :"
    input <- lift getLine
    if null input
        then MaybeT (return Nothing)  -- retourne Nothing si la saisie est vide
        else return input             -- sinon retourne Just input

-- Exemple d'utilisation
main :: IO ()
main = do
    result <- runMaybeT getNonEmptyLine
    case result of
        Nothing  -> putStrLn "Erreur : saisie vide !"
        Just val -> putStrLn $ "Vous avez saisi : " ++ val

