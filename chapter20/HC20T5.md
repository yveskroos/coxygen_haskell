import Control.Monad.Reader

-- Type de configuration
data Config = Config
    { greetingPrefix :: String  -- Exemple : "Hello"
    , showName       :: Bool    -- Afficher le nom ou pas
    }

-- Fonction de salutation qui lit la configuration via Reader
greetUser :: String -> Reader Config String
greetUser name = do
    cfg <- ask  -- Récupère la configuration
    let prefix = greetingPrefix cfg
    let msg = if showName cfg
              then prefix ++ ", " ++ name ++ "!"
              else prefix ++ "!"
    return msg

-- Fonction utilitaire pour exécuter le Reader
runGreeting :: Config -> String -> String
runGreeting cfg name = runReader (greetUser name) cfg

-- Exemple d'utilisation
main :: IO ()
main = do
    let cfg1 = Config "Hello" True
        cfg2 = Config "Welcome" False

    putStrLn $ runGreeting cfg1 "kroos" 
    putStrLn $ runGreeting cfg2 "charlain"    
