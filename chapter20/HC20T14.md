import Control.Monad (mapM)

mapMFilter :: Monad m => (a -> m (Maybe b)) -> [a] -> m [b]
mapMFilter f xs = do
    results <- mapM f xs
    return [y | Just y <- results]

-- Exemple avec Maybe
exampleMaybe :: [Int] -> Maybe [Int]
exampleMaybe = mapMFilter (\x -> return (if even x then Just (x `div` 2) else Nothing))

main :: IO ()
main = do
    print $ exampleMaybe [2,4,6]   -- Just [1,2,3]
    print $ exampleMaybe [2,3,6]   -- Nothing

