import Control.Exception (try, SomeException, toException, IOException)

-- Fonction retryIO corrigée
retryIO :: Int -> IO a -> IO (Either SomeException a)
retryIO n action
    | n <= 0    = return $ Left $ toException $ userError "Nombre de tentatives épuisé"
    | otherwise = do
        result <- try action
        case result of
            Right val -> return (Right val)
            Left (_ :: SomeException) -> retryIO (n - 1) action

-- Exemple d'utilisation
main :: IO ()
main = do
    putStrLn "Tentative de lecture d'un fichier inexistant (3 essais)..."
    result <- retryIO 3 (readFile "fichier_inexistant.txt")
    case result of
        Right content -> putStrLn $ "Succès : " ++ take 100 content
        Left err      -> putStrLn $ "Échec : " ++ show err

