import Control.Monad.Writer

type Calc a = Writer [String] a

add :: Int -> Int -> Calc Int
add x y = writer (x + y, ["Added " ++ show x ++ " and " ++ show y])

sub :: Int -> Int -> Calc Int
sub x y = writer (x - y, ["Subtracted " ++ show y ++ " from " ++ show x])

mul :: Int -> Int -> Calc Int
mul x y = writer (x * y, ["Multiplied " ++ show x ++ " by " ++ show y])

divide :: Int -> Int -> Calc (Maybe Int)
divide _ 0 = writer (Nothing, ["Attempted division by zero"])
divide x y = writer (Just (x `div` y), ["Divided " ++ show x ++ " by " ++ show y])

main :: IO ()
main = do
    -- Exemple 1
    let (result1, log1) = runWriter (add 5 3)
    putStrLn $ "Result: " ++ show result1
    putStrLn "Log:"
    mapM_ putStrLn log1

    -- Exemple 2 : chainage dans un do block
    let (result2, log2) = runWriter $ do
            a <- add 10 2
            b <- mul a 3
            divide b 4
    putStrLn $ "\nResult: " ++ show result2
    putStrLn "Log:"
    mapM_ putStrLn log2

