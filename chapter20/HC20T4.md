import Control.Monad.State
import qualified Data.Map as Map

-- Type pour le compteur : Map de Char vers Int
type CharCount = Map.Map Char Int

-- Fonction qui met à jour le compteur pour un caractère donné
countChar :: Char -> State CharCount ()
countChar c = do
    counts <- get
    let newCounts = Map.insertWith (+) c 1 counts
    put newCounts

-- Fonction qui parcourt toute la chaîne et met à jour le compteur
countChars :: String -> State CharCount ()
countChars = mapM_ countChar

-- Exemple d'utilisation
main :: IO ()
main = do
    let str = "hello world"
        initialState = Map.empty
        finalState = execState (countChars str) initialState
    print finalState

