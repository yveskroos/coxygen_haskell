import Control.Monad.Writer

-- Type pour stocker le journal : une liste de chaînes
type Log = [String]

-- Exemple de fonction avec journalisation
add :: Int -> Int -> Writer Log Int
add x y = do
    tell ["Appel de add avec arguments: " ++ show x ++ ", " ++ show y]
    return (x + y)

multiply :: Int -> Int -> Writer Log Int
multiply x y = do
    tell ["Appel de multiply avec arguments: " ++ show x ++ ", " ++ show y]
    return (x * y)

-- Fonction combinée qui utilise plusieurs opérations
compute :: Writer Log Int
compute = do
    a <- add 2 3
    b <- multiply a 4
    tell ["Résultat final: " ++ show b]
    return b

-- Exemple d'exécution
main :: IO ()
main = do
    let (result, log) = runWriter compute
    putStrLn $ "Résultat: " ++ show result
    putStrLn "Journal:"
    mapM_ putStrLn log
