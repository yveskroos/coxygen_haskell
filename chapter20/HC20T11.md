import Control.Monad.State

type Position = (Int, Int)

-- Générateur déterministe simple basé sur un entier
type MyGen = Int

randomStep :: State MyGen (Int, Int)
randomStep = do
    gen <- get
    let dir = gen `mod` 4
    put (gen + 1)   -- on incrémente pour la prochaine "pseudo-random"
    return $ case dir of
        0 -> (0, 1)   -- Haut
        1 -> (0, -1)  -- Bas
        2 -> (-1, 0)  -- Gauche
        _ -> (1, 0)   -- Droite

randomWalk :: Int -> Position -> State MyGen [Position]
randomWalk 0 pos = return [pos]
randomWalk n pos = do
    step <- randomStep
    let newPos = (fst pos + fst step, snd pos + snd step)
    rest <- randomWalk (n - 1) newPos
    return (pos : rest)

main :: IO ()
main = do
    let path = evalState (randomWalk 10 (0, 0)) 42
    print path
