import System.Directory (listDirectory)
import Data.List (isInfixOf)
import qualified Data.Map as Map

-- Fonction pour filtrer les fichiers selon une sous-chaîne
filtrerFichiers :: String -> IO [String]
filtrerFichiers sousChaine = do
    fichiers <- listDirectory "."
    return $ filter (isInfixOf sousChaine) fichiers

-- Fonction pour convertir une liste de fichiers en Map
-- La clé sera l'index et la valeur le nom du fichier
fichiersEnMap :: [String] -> Map.Map Int String
fichiersEnMap fichiers = Map.fromList $ zip [1..] fichiers

-- Programme principal pour tester
main :: IO ()
main = do
    putStrLn "Entrez une sous-chaîne pour filtrer les fichiers :"
    sousChaine <- getLine
    fichiers <- filtrerFichiers sousChaine
    let mapFichiers = fichiersEnMap fichiers
    putStrLn "Fichiers filtrés convertis en Map :"
    print mapFichiers
